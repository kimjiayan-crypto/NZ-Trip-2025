<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç´è¥¿è˜­ 15 å¤©å®¶æ—è‡ªé§•å°è¦½</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #2c3e50; --accent: #e67e22; --bg: #fdfdfd; }
        body { margin: 0; font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; display: flex; flex-direction: column; height: 100vh; background: var(--bg); }
        header { background: var(--primary); color: white; padding: 15px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 1000; }
        #container { display: flex; flex: 1; overflow: hidden; }
        #sidebar { width: 380px; overflow-y: auto; padding: 15px; border-right: 1px solid #ddd; background: #fff; }
        #map { flex: 1; }
        
        /* æ¯æ—¥è¡Œç¨‹å¡ç‰‡æ¨£å¼ */
        .day-box { background: white; border-radius: 12px; padding: 16px; margin-bottom: 15px; border: 1px solid #eee; transition: all 0.3s ease; cursor: pointer; }
        .day-box:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-left: 6px solid var(--accent); }
        .active-day { border-left: 6px solid var(--accent); background: #fff9f5; }
        .day-num-title { font-size: 1.1rem; font-weight: bold; color: #2c3e50; display: flex; align-items: center; }
        .day-num-badge { background: var(--accent); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-size: 0.8rem; }
        .route-info { color: #7f8c8d; font-size: 0.85rem; margin: 8px 0; display: flex; align-items: center; }
        .details { font-size: 0.9rem; color: #555; line-height: 1.6; }
        
        /* è‡ªå®šç¾©æ•¸å­—åœ–æ¨™æ¨£å¼ */
        .custom-div-icon { background: none; border: none; }
        .marker-pin { width: 30px; height: 30px; border-radius: 50% 50% 50% 0; background: #e67e22; position: absolute; transform: rotate(-45deg); left: 50%; top: 50%; margin: -15px 0 0 -15px; border: 2px solid #fff; }
        .marker-pin::after { content: ''; width: 24px; height: 24px; margin: 3px 0 0 3px; background: #fff; position: absolute; border-radius: 50%; }
        .marker-text { position: absolute; width: 30px; height: 30px; top: 0; left: 0; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #e67e22; font-size: 12px; z-index: 10; }

        @media (max-width: 768px) { #container { flex-direction: column-reverse; } #sidebar { width: 100%; height: 40%; } #map { height: 60%; } }
    </style>
</head>
<body>

<header>ğŸ‡³ğŸ‡¿ ç´è¥¿è˜­è‡ªé§•è¡Œç¨‹ï¼šDay æ•¸å­—æ¨™è¨»ç‰ˆ</header>

<div id="container">
    <div id="sidebar"></div>
    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. è¡Œç¨‹è³‡æ–™èˆ‡åº§æ¨™
    const itinerary = [
        { day: 2, title: "åŸºç£åŸå–è»Š", route: "CHC æ©Ÿå ´ â†’ å¸‚å€", dist: "12km", details: "é›…èŠ³æ²³æ’èˆ¹ã€ç´™æ•™å ‚ã€Riverside Market", pos: [-43.532, 172.636] },
        { day: 3, title: "Tekapo æ˜Ÿç©ºæ¹–æ³Š", route: "åŸºç£åŸ â†’ Tekapo", dist: "225km", details: "Fairlie è²·æ´¾ã€å–„ç‰§æ•™å ‚ã€æ¹–é‚Šè§€æ˜Ÿ", pos: [-44.004, 170.477] },
        { day: 4, title: "åº«å…‹å±±å¥è¡Œ", route: "Tekapo â†’ Mt Cook", dist: "105km", details: "Hooker Valley æ­¥é“ã€æ™®å¡åŸºæ¹–ã€éš±å£«é£¯åº—", pos: [-43.734, 170.096] },
        { day: 5, title: "å¥§ç‘ªé­¯ä¼éµ", route: "Mt Cook â†’ Oamaru", dist: "215km", details: "Moeraki å¤§åœ“çŸ³ã€è—ä¼éµæ­¸å·¢", pos: [-45.097, 170.970] },
        { day: 6, title: "Wanaka æ¹–ç•”", route: "Oamaru â†’ Wanaka", dist: "280km", details: "Lindis Passã€High Country Salmonã€é‚£æ£µæ¨¹", pos: [-44.694, 169.132] },
        { day: 9, title: "æŠµé”çš‡åé®", route: "Wanaka â†’ çš‡åé®", dist: "70km", details: "çš‡å† å…¬è·¯ã€ç®­é®ã€Skyline å¤œæ™¯", pos: [-45.031, 168.662] },
        { day: 11, title: "é­”æˆ’æ ¼èŠè«¾åŸº", route: "çš‡åé® â†’ Glenorchy", dist: "45km", details: "æ¹–ç•”å…¬è·¯ã€Glenorchy ç¢¼é ­å¤§æ™¯", pos: [-44.850, 168.385] },
        { day: 12, title: "è’‚é˜¿ç‘™è¢ç«èŸ²", route: "çš‡åé® â†’ Te Anau", dist: "175km", details: "Te Anau æ¹–ã€è¢ç«èŸ²æ´å°è¦½", pos: [-45.414, 167.717] },
        { day: 13, title: "ç±³ä½›å³½ç£", route: "Te Anau â†’ Milford", dist: "120km", details: "å³½ç£éŠèˆ¹ã€é¡æ¹–ã€ç±³ä½›æ™¯è§€å…¬è·¯", pos: [-44.671, 167.926] }
    ];

    // 2. åˆå§‹åŒ–åœ°åœ–
    const map = L.map('map').setView([-44.5, 170.5], 7);
    L.tileLayer('https://{s}.tile.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

    // 3. ç¹ªè£½é€£ç·š (è¡Œç¨‹è·¯å¾‘)
    const pathCoords = itinerary.map(item => item.pos);
    L.polyline(pathCoords, { color: '#e67e22', weight: 3, opacity: 0.6, dashArray: '8, 8' }).addTo(map);

    const sidebar = document.getElementById('sidebar');

    // 4. ç”Ÿæˆå…§å®¹èˆ‡è‡ªå®šç¾©æ¨™è¨˜
    itinerary.forEach((item) => {
        // è‡ªå®šç¾©ã€Œå¸¶æ•¸å­—ã€çš„åœ–æ¨™
        const customIcon = L.divIcon({
            className: 'custom-div-icon',
            html: `<div class='marker-pin'></div><div class='marker-text'>${item.day}</div>`,
            iconSize: [30, 42],
            iconAnchor: [15, 42]
        });

        const marker = L.marker(item.pos, { icon: customIcon }).addTo(map)
            .bindPopup(`<b>Day ${item.day}: ${item.title}</b><br>${item.route}`);

        // å»ºç«‹å·¦å´åˆ—è¡¨
        const card = document.createElement('div');
        card.className = 'day-box';
        card.innerHTML = `
            <div class="day-num-title">
                <div class="day-num-badge">${item.day}</div>
                ${item.title}
            </div>
            <div class="route-info">ğŸ“ ${item.route} (ç´„ ${item.dist})</div>
            <div class="details">${item.details}</div>
        `;

        card.onclick = () => {
            map.flyTo(item.pos, 11);
            marker.openPopup();
            document.querySelectorAll('.day-box').forEach(b => b.classList.remove('active-day'));
            card.classList.add('active-day');
        };

        sidebar.appendChild(card);
    });
</script>
</body>
</html>
