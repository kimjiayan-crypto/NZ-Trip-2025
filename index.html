<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç´è¥¿è˜­ 15 å¤©å®Œæ•´è¡Œç¨‹å°è¦½</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #2c3e50; --accent: #e67e22; --bg: #fdfdfd; }
        body { margin: 0; font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; display: flex; flex-direction: column; height: 100vh; background: var(--bg); }
        header { background: var(--primary); color: white; padding: 12px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 1000; }
        #container { display: flex; flex: 1; overflow: hidden; }
        #sidebar { width: 380px; overflow-y: auto; padding: 15px; border-right: 1px solid #ddd; background: #fff; z-index: 999; }
        #map { flex: 1; height: 100%; background: #eee; } /* ç¢ºä¿èƒŒæ™¯è‰²ä»¥ä¾¿è§€å¯ŸåŠ è¼‰ */
        
        .day-box { background: white; border-radius: 12px; padding: 16px; margin-bottom: 15px; border: 1px solid #eee; transition: all 0.3s ease; cursor: pointer; }
        .day-box:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-left: 6px solid var(--accent); }
        .active-day { border-left: 6px solid var(--accent); background: #fff9f5; }
        .day-num-title { font-size: 1.1rem; font-weight: bold; color: #2c3e50; display: flex; align-items: center; }
        .day-num-badge { background: var(--accent); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-size: 0.8rem; flex-shrink: 0; }
        .route-info { color: #7f8c8d; font-size: 0.85rem; margin: 8px 0; }
        .details { font-size: 0.9rem; color: #555; line-height: 1.6; white-space: pre-line; }
        
        /* è‡ªå®šç¾©æ•¸å­—åœ–æ¨™ */
        .custom-div-icon { background: none; border: none; }
        .marker-pin { width: 30px; height: 30px; border-radius: 50% 50% 50% 0; background: #e67e22; position: absolute; transform: rotate(-45deg); left: 50%; top: 50%; margin: -15px 0 0 -15px; border: 2px solid #fff; }
        .marker-pin::after { content: ''; width: 24px; height: 24px; margin: 3px 0 0 3px; background: #fff; position: absolute; border-radius: 50%; }
        .marker-text { position: absolute; width: 30px; height: 30px; top: 0; left: 0; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #e67e22; font-size: 12px; z-index: 10; }

        @media (max-width: 768px) { #container { flex-direction: column-reverse; } #sidebar { width: 100%; height: 45%; } #map { height: 55%; } }
    </style>
</head>
<body>

<header>ğŸ‡³ğŸ‡¿ ç´è¥¿è˜­ 15 å¤©å…¨ç´€éŒ„ (å«è»Šç¨‹æ™‚é–“)</header>

<div id="container">
    <div id="sidebar" id="itinerary-list"></div>
    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const itinerary = [
        { day: 1, title: "å°åŒ—å•Ÿç¨‹", route: "TPE -> AKL", time: "é£›èˆªä¸­", details: "18:30 TPE èµ·é£›ï¼ˆç¶“å¥§å…‹è˜­è½‰æ©Ÿï¼‰", pos: [-37.008, 174.791] },
        { day: 2, title: "æŠµé”åŸºç£åŸ", route: "CHC æ©Ÿå ´ -> å¸‚å€", time: "20 min", details: "13:00 æŠµé”å–è»Š\n16:30 é›…èŠ³æ²³æ’èˆ¹/æ¤ç‰©åœ’æ•£æ­¥\n17:30 ç´™æ•™å ‚/Riverside Market", pos: [-43.532, 172.636] },
        { day: 3, title: "åŸºç£åŸ â†’ Tekapo", route: "åŸºç£åŸ -> Tekapo", time: "3 hr", details: "ä¸­é€”åœ Geraldine/Fairlie è²·æ´¾\n14:00 å–„ç‰§æ•™å ‚\n19:30 æ˜Ÿç©ºè§€æ˜Ÿè¡Œç¨‹", pos: [-44.004, 170.477] },
        { day: 4, title: "åº«å…‹å±±å¥è¡Œ", route: "Tekapo -> Mt Cook", time: "1 hr 15 min", details: "11:15 Hooker Valley Track (3.5hr)\nå…¥ä½éš±å£«é£¯åº— The Hermitage", pos: [-43.734, 170.096] },
        { day: 5, title: "æ±å²¸çœ‹ä¼éµ", route: "Mt Cook -> Oamaru", time: "2 hr 40 min", details: "12:30 Moeraki Boulders å¤§åœ“çŸ³\n16:00 Bushy Beach é»ƒçœ¼ä¼éµ\n19:00 è—ä¼éµæ­¸å·¢", pos: [-45.097, 170.970] },
        { day: 6, title: "å‰å¾€ Wanaka", route: "Oamaru -> Wanaka", time: "3 hr 15 min", details: "ä¸­é€”åœ Omarama åƒé®­é­šç”Ÿé­šç‰‡\nç¶“éçµ•ç¾ Lindis Pass\nå‚æ™šï¼šThat Wanaka Tree", pos: [-44.694, 169.132] },
        { day: 7, title: "Wanaka æ»‘é›ªæ—¥", route: "Wanaka -> Cardrona", time: "45 min", details: "Cardrona æ»‘é›ªå ´\nä¸æ»‘é›ªè€…ï¼šè–°è¡£è‰è¾²å ´/Puzzling World", pos: [-44.863, 169.004] },
        { day: 8, title: "Wanaka è‡ªç”±æ—¥", route: "å°é®æ”¾é¬†", time: "N/A", details: "æ¹–ç•”æ•£æ­¥ / Roys Peak è§€æ™¯é»æ‹æ”", pos: [-44.694, 169.132] },
        { day: 9, title: "å‰å¾€çš‡åé®", route: "Wanaka -> Queenstown", time: "1 hr 15 min", details: "èµ° Crown Range çš‡å† å…¬è·¯\nä¸­é€”ï¼šç®­é® Arrowtown æ¼«æ­¥", pos: [-45.031, 168.662] },
        { day: 10, title: "çš‡åé®æ»‘é›ªæ—¥", route: "å¸‚å€ -> å“è¶Šå±±", time: "40 min", details: "å“è¶Šå±±æ»‘é›ªå ´\nä¸æ»‘é›ªè€…ï¼šSkyline Gondola + Luge", pos: [-45.059, 168.814] },
        { day: 11, title: "é­”ç•Œå¤§æ™¯ä¸€æ—¥", route: "çš‡åé® -> Glenorchy", time: "45 min", details: "Glenorchy Wharf ç¢¼é ­\næœ€ç¾æ¹–ç•”å…¬è·¯åœé æ‹ç…§", pos: [-44.850, 168.385] },
        { day: 12, title: "è’‚é˜¿ç‘™è¢ç«èŸ²", route: "çš‡åé® -> Te Anau", time: "2 hr", details: "ä¸‹åˆï¼šTe Anau æ¹–é‚Šæ•£æ­¥\n19:00 è¢ç«èŸ²æ´å°è¦½", pos: [-45.414, 167.717] },
        { day: 13, title: "ç±³ä½›å³½ç£", route: "Te Anau -> Milford", time: "2 hr 15 min", details: "Milford Sound ä¸€æ—¥éŠèˆ¹åœ˜\n(07:00-19:00 å·´å£«+éŠèˆ¹)", pos: [-44.671, 167.926] },
        { day: 14, title: "é‡è¿”çš‡åé®", route: "Te Anau -> Queenstown", time: "2 hr", details: "æœ€å¾Œæ¡è²·ã€æ•£æ­¥ã€æ—©ç¡æº–å‚™å›ç¨‹", pos: [-45.031, 168.662] },
        { day: 15, title: "å›å°", route: "ZQN -> TPE", time: "é£›èˆªä¸­", details: "07:00 ZQN èµ·é£› -> AKL è½‰æ©Ÿ -> å°åŒ—", pos: [-45.018, 168.745] }
    ];

    // åˆå§‹åŒ–åœ°åœ– - å¢åŠ ç©©å®šæ€§
    const map = L.map('map', {
        center: [-44.2, 170.5],
        zoom: 7,
        layers: [L.tileLayer('https://{s}.tile.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png')]
    });

    // å»¶é²é‡ç¹ªç¢ºä¿åœ°åœ–é¡¯ç¤ºæ­£ç¢º
    setTimeout(() => { map.invalidateSize(); }, 500);

    const sidebar = document.getElementById('sidebar');

    itinerary.forEach((item) => {
        // è‡ªå®šç¾©æ¨™è¨˜
        const customIcon = L.divIcon({
            className: 'custom-div-icon',
            html: `<div class='marker-pin'></div><div class='marker-text'>${item.day}</div>`,
            iconSize: [30, 42],
            iconAnchor: [15, 42]
        });

        const marker = L.marker(item.pos, { icon: customIcon }).addTo(map)
            .bindPopup(`<b>Day ${item.day}: ${item.title}</b><br>ğŸš— è»Šç¨‹ï¼š${item.time}<br>ğŸ“ ${item.route}`);

        // å»ºç«‹å·¦å´åˆ—è¡¨
        const card = document.createElement('div');
        card.className = 'day-box';
        card.innerHTML = `
            <div class="day-num-title">
                <div class="day-num-badge">${item.day}</div>
                ${item.title}
            </div>
            <div class="route-info">ğŸš— è»Šç¨‹æ™‚é–“ï¼š<b>${item.time}</b><br>ğŸ“ ${item.route}</div>
            <div class="details">${item.details}</div>
        `;

        card.onclick = () => {
            map.flyTo(item.pos, 11);
            marker.openPopup();
            document.querySelectorAll('.day-box').forEach(b => b.classList.remove('active-day'));
            card.classList.add('active-day');
        };

        sidebar.appendChild(card);
    });

    // ç¹ªè£½è·¯å¾‘é€£ç·š
    const pathCoords = itinerary.map(i => i.pos);
    L.polyline(pathCoords, { color: '#e67e22', weight: 2, opacity: 0.5, dashArray: '5, 10' }).addTo(map);
</script>
</body>
</html>
