<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ç´è¥¿è˜­è‡ªé§•å°èˆªç³»çµ±</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #1a2a3a; --accent: #e67e22; --bg: #f4f7f6; }
        body { margin: 0; font-family: "PingFang TC", sans-serif; display: flex; flex-direction: column; height: 100vh; background: var(--bg); }
        header { background: var(--primary); color: white; padding: 12px; text-align: center; font-weight: bold; }
        #container { display: flex; flex: 1; overflow: hidden; }
        #sidebar { width: 420px; display: flex; flex-direction: column; border-right: 1px solid #ddd; background: white; }
        #day-selector { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; padding: 10px; background: #eee; }
        .day-btn { padding: 8px; border: none; background: #fff; cursor: pointer; border-radius: 4px; font-weight: bold; font-size: 0.75rem; }
        .day-btn.active { background: var(--accent); color: white; }
        #day-content { flex: 1; overflow-y: auto; padding: 20px; }
        #map { flex: 1; z-index: 1; }
        .card { background: #fff; border: 1px solid #eee; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .label { font-weight: bold; color: #7f8c8d; font-size: 0.8rem; margin-top: 10px; display: block; }
        .value { font-size: 0.95rem; color: #2c3e50; margin-bottom: 5px; display: block; }
        .sch-box { border-left: 3px solid var(--accent); padding-left: 10px; margin-top: 10px; }
        .sch-item { margin-bottom: 8px; font-size: 0.9rem; }
        .sch-tag { color: var(--accent); font-weight: bold; margin-right: 5px; }
        @media (max-width: 768px) { #container { flex-direction: column-reverse; } #sidebar { width: 100%; height: 50%; } }
    </style>
</head>
<body>

<header>ğŸ‡³ğŸ‡¿ 2026 ç´è¥¿è˜­ 15 å¤©è‡ªé§•å°èˆª (è·¯ç¶²å¯¦é…ç‰ˆ)</header>

<div id="container">
    <div id="sidebar">
        <div id="day-selector"></div>
        <div id="day-content"><div id="details">è«‹é¸æ“‡å¤©æ•¸</div></div>
    </div>
    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>

<script>
    const itinerary = [
        { day: 1, title: "å°åŒ—å•Ÿç¨‹", stay: "æ©Ÿä¸Š", drive: "TPE âœˆ AKL", driveTime: "11hr", totalTime: "11hr", schedule: { morning: "æº–å‚™å‡ºç™¼", noon: "æ©Ÿå ´å ±åˆ°", evening: "18:30 èµ·é£›" }, 
          waypoints: [[-37.008, 174.791]], spots: [{name: "å¥§å…‹è˜­æ©Ÿå ´", pos: [-37.008, 174.791]}] },
        { day: 2, title: "æŠµé”åŸºç£åŸ", stay: "The Grange Boutique B&B", drive: "CHCæ©Ÿå ´ â†’ é£¯åº—", driveTime: "20m", totalTime: "2hr", schedule: { morning: "å¥§å…‹è˜­è½‰æ©Ÿ", noon: "13:00 å–è»Š", evening: "é›…èŠ³æ²³æ’èˆ¹ã€ç´™æ•™å ‚" },
          waypoints: [[-43.489, 172.532], [-43.525, 172.630]], spots: [{name: "å–è»Šé»", pos: [-43.489, 172.532]}, {name: "é›…èŠ³æ²³", pos: [-43.530, 172.635]}, {name: "ç´™æ•™å ‚", pos: [-43.532, 172.640]}] },
        { day: 3, title: "å‰å¾€ Tekapo", stay: "Peppers Bluewater", drive: "åŸºç£åŸ â†’ Tekapo", driveTime: "3hr", totalTime: "5hr", schedule: { morning: "09:00 å‡ºç™¼", noon: "Fairlie è²·æ´¾", evening: "å–„ç‰§æ•™å ‚ã€è§€æ˜Ÿ" },
          waypoints: [[-43.525, 172.630], [-44.004, 170.477]], spots: [{name: "Fairlie Bakehouse", pos: [-44.095, 170.829]}, {name: "å–„ç‰§æ•™å ‚", pos: [-44.003, 170.482]}] },
        { day: 4, title: "åº«å…‹å±±å¥è¡Œ", stay: "The Hermitage", drive: "Tekapo â†’ Mt Cook", driveTime: "1.2hr", totalTime: "4hr", schedule: { morning: "Pukaki æ¹–æ‹ç…§", noon: "Hooker Valley å¥è¡Œ", evening: "éš±å£«é£¯åº—å¤•é™½" },
          waypoints: [[-44.004, 170.477], [-43.734, 170.096]], spots: [{name: "Peter's Lookout", pos: [-44.185, 170.151]}, {name: "Hooker Valley Track", pos: [-43.719, 170.103]}] },
        { day: 5, title: "è«æ‹‰åŸºå¤§åœ“çŸ³", stay: "Oamaru", drive: "Mt Cook â†’ Oamaru", driveTime: "2.7hr", totalTime: "5hr", schedule: { morning: "å¾€æ±å²¸ç§»å‹•", noon: "è«æ‹‰åŸºæ‹ç…§", evening: "ä¼éµæ­¸å·¢" },
          waypoints: [[-43.734, 170.096], [-45.345, 170.826], [-45.097, 170.970]], spots: [{name: "High Country Salmon", pos: [-44.485, 169.987]}, {name: "Moeraki Boulders", pos: [-45.345, 170.826]}] },
        { day: 13, title: "ç±³ä½›å³½ç£", stay: "Te Anau", drive: "Te Anau â†” Milford", driveTime: "4.5hr", totalTime: "11hr", schedule: { morning: "å³½ç£å…¬è·¯", noon: "éŠèˆ¹åˆé¤", evening: "å›ç¨‹åœ“é±ˆæ´¾" },
          waypoints: [[-45.414, 167.717], [-44.671, 167.926]], spots: [{name: "é¡æ¹– Mirror Lakes", pos: [-44.939, 168.012]}, {name: "è·é¦¬éš§é“", pos: [-44.764, 167.942]}, {name: "Milford Cruise", pos: [-44.671, 167.926]}] }
        // ... å…¶ä»–å¤©æ•¸ä¾æ­¤é¡æ¨
    ];

    const map = L.map('map').setView([-44.2, 170.5], 7);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

    let control;
    let spotMarkers = L.layerGroup().addTo(map);

    function showDay(item, btn) {
        document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        document.getElementById('details').innerHTML = `
            <div class="card">
                <h2 style="margin-top:0;">D${item.day}: ${item.title}</h2>
                <span class="label">ğŸ  ä½å®¿</span><span class="value">${item.stay}</span>
                <span class="label">ğŸš— è·¯ç·š</span><span class="value">${item.drive}</span>
                <span class="label">â±ï¸ æ™‚é–“ (ç´”é–‹è»Š/é ä¼°)</span><span class="value">${item.driveTime} / ${item.totalTime}</span>
                <div class="sch-box">
                    <div class="sch-item"><span class="sch-tag">æ—©</span>${item.schedule.morning}</div>
                    <div class="sch-item"><span class="sch-tag">ä¸­</span>${item.schedule.noon}</div>
                    <div class="sch-item"><span class="sch-tag">æ™š</span>${item.schedule.evening}</div>
                </div>
            </div>`;

        // 1. å¯¦éš›äº¤é€šè·¯ç·šç¹ªè£½
        if (control) map.removeControl(control);
        if (item.waypoints.length > 1) {
            control = L.Routing.control({
                waypoints: item.waypoints.map(p => L.latLng(p[0], p[1])),
                lineOptions: { styles: [{ color: '#e67e22', weight: 4 }] },
                createMarker: () => null, // ä¸é¡¯ç¤ºè·¯ç¶²é è¨­çš„ A/B æ¨™è¨˜
                addWaypoints: false, draggableWaypoints: false, fitSelectedRoutes: true, show: false
            }).addTo(map);
        } else {
            map.flyTo(item.waypoints[0], 10);
        }

        // 2. é¡¯ç¤ºç•¶å¤©æ™¯é»åœ–æ¨™
        spotMarkers.clearLayers();
        item.spots.forEach(spot => {
            L.marker(spot.pos).addTo(spotMarkers).bindPopup(`<b>${spot.name}</b>`).openPopup();
        });
    }

    const selector = document.getElementById('day-selector');
    itinerary.forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'day-btn'; btn.innerText = `D${item.day}`;
        btn.onclick = () => showDay(item, btn);
        selector.appendChild(btn);
    });

    // é è¨­é¡¯ç¤ºç¬¬ä¸€å¤©
    setTimeout(() => selector.firstChild.click(), 500);
</script>
</body>
</html>
